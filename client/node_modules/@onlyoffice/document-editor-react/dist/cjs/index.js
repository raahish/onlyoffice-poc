"use strict";var t=require("react");function e(t,e,r,n){return new(r||(r=Promise))((function(o,a){function i(t){try{u(n.next(t))}catch(t){a(t)}}function c(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,c)}u((n=n.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const r=(t,e,r,n)=>{const o=document.createElement("script");return o.id=t,o.type="text/javascript",o.src=e,o.async=!0,o.onload=()=>{o.removeAttribute("loading"),r(null)},o.onerror=t=>{o.removeAttribute("loading"),n(t)},o.setAttribute("loading",""),o};var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var a=function(){this.__data__=[],this.size=0};var i=function(t,e){return t===e||t!=t&&e!=e},c=i;var u=function(t,e){for(var r=t.length;r--;)if(c(t[r][0],e))return r;return-1},s=u,l=Array.prototype.splice;var v=u;var f=u;var p=u;var d=a,y=function(t){var e=this.__data__,r=s(e,t);return!(r<0)&&(r==e.length-1?e.pop():l.call(e,r,1),--this.size,!0)},b=function(t){var e=this.__data__,r=v(e,t);return r<0?void 0:e[r][1]},h=function(t){return f(this.__data__,t)>-1},_=function(t,e){var r=this.__data__,n=p(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function j(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}j.prototype.clear=d,j.prototype.delete=y,j.prototype.get=b,j.prototype.has=h,j.prototype.set=_;var w=j,g=w;var m=function(){this.__data__=new g,this.size=0};var A=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var O=function(t){return this.__data__.get(t)};var R=function(t){return this.__data__.has(t)},S="object"==typeof n&&n&&n.Object===Object&&n,E=S,D="object"==typeof self&&self&&self.Object===Object&&self,x=E||D||Function("return this")(),q=x.Symbol,I=q,P=Object.prototype,z=P.hasOwnProperty,M=P.toString,U=I?I.toStringTag:void 0;var C=function(t){var e=z.call(t,U),r=t[U];try{t[U]=void 0;var n=!0}catch(t){}var o=M.call(t);return n&&(e?t[U]=r:delete t[U]),o},F=Object.prototype.toString;var T=C,k=function(t){return F.call(t)},B=q?q.toStringTag:void 0;var $=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":B&&B in Object(t)?T(t):k(t)};var L=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},W=$,H=L;var N,V=function(t){if(!H(t))return!1;var e=W(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},G=x["__core-js_shared__"],J=(N=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||""))?"Symbol(src)_1."+N:"";var K=function(t){return!!J&&J in t},Q=Function.prototype.toString;var X=function(t){if(null!=t){try{return Q.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Y=V,Z=K,tt=L,et=X,rt=/^\[object .+?Constructor\]$/,nt=Function.prototype,ot=Object.prototype,at=nt.toString,it=ot.hasOwnProperty,ct=RegExp("^"+at.call(it).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ut=function(t){return!(!tt(t)||Z(t))&&(Y(t)?ct:rt).test(et(t))},st=function(t,e){return null==t?void 0:t[e]};var lt=function(t,e){var r=st(t,e);return ut(r)?r:void 0},vt=lt(x,"Map"),ft=lt(Object,"create"),pt=ft;var dt=function(){this.__data__=pt?pt(null):{},this.size=0};var yt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},bt=ft,ht=Object.prototype.hasOwnProperty;var _t=function(t){var e=this.__data__;if(bt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return ht.call(e,t)?e[t]:void 0},jt=ft,wt=Object.prototype.hasOwnProperty;var gt=ft;var mt=dt,At=yt,Ot=_t,Rt=function(t){var e=this.__data__;return jt?void 0!==e[t]:wt.call(e,t)},St=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=gt&&void 0===e?"__lodash_hash_undefined__":e,this};function Et(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Et.prototype.clear=mt,Et.prototype.delete=At,Et.prototype.get=Ot,Et.prototype.has=Rt,Et.prototype.set=St;var Dt=Et,xt=w,qt=vt;var It=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Pt=function(t,e){var r=t.__data__;return It(e)?r["string"==typeof e?"string":"hash"]:r.map},zt=Pt;var Mt=Pt;var Ut=Pt;var Ct=Pt;var Ft=function(){this.size=0,this.__data__={hash:new Dt,map:new(qt||xt),string:new Dt}},Tt=function(t){var e=zt(this,t).delete(t);return this.size-=e?1:0,e},kt=function(t){return Mt(this,t).get(t)},Bt=function(t){return Ut(this,t).has(t)},$t=function(t,e){var r=Ct(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Lt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Lt.prototype.clear=Ft,Lt.prototype.delete=Tt,Lt.prototype.get=kt,Lt.prototype.has=Bt,Lt.prototype.set=$t;var Wt=w,Ht=vt,Nt=Lt;var Vt=w,Gt=m,Jt=A,Kt=O,Qt=R,Xt=function(t,e){var r=this.__data__;if(r instanceof Wt){var n=r.__data__;if(!Ht||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Nt(n)}return r.set(t,e),this.size=r.size,this};function Yt(t){var e=this.__data__=new Vt(t);this.size=e.size}Yt.prototype.clear=Gt,Yt.prototype.delete=Jt,Yt.prototype.get=Kt,Yt.prototype.has=Qt,Yt.prototype.set=Xt;var Zt=Yt;var te=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},ee=lt,re=function(){try{var t=ee(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var ne=function(t,e,r){"__proto__"==e&&re?re(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},oe=ne,ae=i,ie=Object.prototype.hasOwnProperty;var ce=function(t,e,r){var n=t[e];ie.call(t,e)&&ae(n,r)&&(void 0!==r||e in t)||oe(t,e,r)},ue=ce,se=ne;var le=function(t,e,r,n){var o=!r;r||(r={});for(var a=-1,i=e.length;++a<i;){var c=e[a],u=n?n(r[c],t[c],c,r,t):void 0;void 0===u&&(u=t[c]),o?se(r,c,u):ue(r,c,u)}return r};var ve=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var fe=function(t){return null!=t&&"object"==typeof t},pe=$,de=fe;var ye=function(t){return de(t)&&"[object Arguments]"==pe(t)},be=fe,he=Object.prototype,_e=he.hasOwnProperty,je=he.propertyIsEnumerable,we=ye(function(){return arguments}())?ye:function(t){return be(t)&&_e.call(t,"callee")&&!je.call(t,"callee")},ge=Array.isArray,me={exports:{}};var Ae=function(){return!1};!function(t,e){var r=x,n=Ae,o=e&&!e.nodeType&&e,a=o&&t&&!t.nodeType&&t,i=a&&a.exports===o?r.Buffer:void 0,c=(i?i.isBuffer:void 0)||n;t.exports=c}(me,me.exports);var Oe=me.exports,Re=/^(?:0|[1-9]\d*)$/;var Se=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Re.test(t))&&t>-1&&t%1==0&&t<e};var Ee=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},De=$,xe=Ee,qe=fe,Ie={};Ie["[object Float32Array]"]=Ie["[object Float64Array]"]=Ie["[object Int8Array]"]=Ie["[object Int16Array]"]=Ie["[object Int32Array]"]=Ie["[object Uint8Array]"]=Ie["[object Uint8ClampedArray]"]=Ie["[object Uint16Array]"]=Ie["[object Uint32Array]"]=!0,Ie["[object Arguments]"]=Ie["[object Array]"]=Ie["[object ArrayBuffer]"]=Ie["[object Boolean]"]=Ie["[object DataView]"]=Ie["[object Date]"]=Ie["[object Error]"]=Ie["[object Function]"]=Ie["[object Map]"]=Ie["[object Number]"]=Ie["[object Object]"]=Ie["[object RegExp]"]=Ie["[object Set]"]=Ie["[object String]"]=Ie["[object WeakMap]"]=!1;var Pe=function(t){return qe(t)&&xe(t.length)&&!!Ie[De(t)]};var ze=function(t){return function(e){return t(e)}},Me={exports:{}};!function(t,e){var r=S,n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,a=o&&o.exports===n&&r.process,i=function(){try{var t=o&&o.require&&o.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=i}(Me,Me.exports);var Ue=Me.exports,Ce=Pe,Fe=ze,Te=Ue&&Ue.isTypedArray,ke=Te?Fe(Te):Ce,Be=ve,$e=we,Le=ge,We=Oe,He=Se,Ne=ke,Ve=Object.prototype.hasOwnProperty;var Ge=function(t,e){var r=Le(t),n=!r&&$e(t),o=!r&&!n&&We(t),a=!r&&!n&&!o&&Ne(t),i=r||n||o||a,c=i?Be(t.length,String):[],u=c.length;for(var s in t)!e&&!Ve.call(t,s)||i&&("length"==s||o&&("offset"==s||"parent"==s)||a&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||He(s,u))||c.push(s);return c},Je=Object.prototype;var Ke=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Je)};var Qe=function(t,e){return function(r){return t(e(r))}},Xe=Qe(Object.keys,Object),Ye=Ke,Ze=Xe,tr=Object.prototype.hasOwnProperty;var er=V,rr=Ee;var nr=function(t){return null!=t&&rr(t.length)&&!er(t)},or=Ge,ar=function(t){if(!Ye(t))return Ze(t);var e=[];for(var r in Object(t))tr.call(t,r)&&"constructor"!=r&&e.push(r);return e},ir=nr;var cr=function(t){return ir(t)?or(t):ar(t)},ur=le,sr=cr;var lr=function(t,e){return t&&ur(e,sr(e),t)};var vr=L,fr=Ke,pr=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},dr=Object.prototype.hasOwnProperty;var yr=Ge,br=function(t){if(!vr(t))return pr(t);var e=fr(t),r=[];for(var n in t)("constructor"!=n||!e&&dr.call(t,n))&&r.push(n);return r},hr=nr;var _r=function(t){return hr(t)?yr(t,!0):br(t)},jr=le,wr=_r;var gr=function(t,e){return t&&jr(e,wr(e),t)},mr={exports:{}};!function(t,e){var r=x,n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,a=o&&o.exports===n?r.Buffer:void 0,i=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=i?i(r):new t.constructor(r);return t.copy(n),n}}(mr,mr.exports);var Ar=mr.exports;var Or=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var Rr=function(){return[]},Sr=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,a=[];++r<n;){var i=t[r];e(i,r,t)&&(a[o++]=i)}return a},Er=Rr,Dr=Object.prototype.propertyIsEnumerable,xr=Object.getOwnPropertySymbols,qr=xr?function(t){return null==t?[]:(t=Object(t),Sr(xr(t),(function(e){return Dr.call(t,e)})))}:Er,Ir=le,Pr=qr;var zr=function(t,e){return Ir(t,Pr(t),e)};var Mr=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t},Ur=Qe(Object.getPrototypeOf,Object),Cr=Mr,Fr=Ur,Tr=qr,kr=Rr,Br=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Cr(e,Tr(t)),t=Fr(t);return e}:kr,$r=le,Lr=Br;var Wr=function(t,e){return $r(t,Lr(t),e)},Hr=Mr,Nr=ge;var Vr=function(t,e,r){var n=e(t);return Nr(t)?n:Hr(n,r(t))},Gr=Vr,Jr=qr,Kr=cr;var Qr=function(t){return Gr(t,Kr,Jr)},Xr=Vr,Yr=Br,Zr=_r;var tn=function(t){return Xr(t,Zr,Yr)},en=lt(x,"DataView"),rn=vt,nn=lt(x,"Promise"),on=lt(x,"Set"),an=lt(x,"WeakMap"),cn=$,un=X,sn="[object Map]",ln="[object Promise]",vn="[object Set]",fn="[object WeakMap]",pn="[object DataView]",dn=un(en),yn=un(rn),bn=un(nn),hn=un(on),_n=un(an),jn=cn;(en&&jn(new en(new ArrayBuffer(1)))!=pn||rn&&jn(new rn)!=sn||nn&&jn(nn.resolve())!=ln||on&&jn(new on)!=vn||an&&jn(new an)!=fn)&&(jn=function(t){var e=cn(t),r="[object Object]"==e?t.constructor:void 0,n=r?un(r):"";if(n)switch(n){case dn:return pn;case yn:return sn;case bn:return ln;case hn:return vn;case _n:return fn}return e});var wn=jn,gn=Object.prototype.hasOwnProperty;var mn=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&gn.call(t,"index")&&(r.index=t.index,r.input=t.input),r},An=x.Uint8Array;var On=function(t){var e=new t.constructor(t.byteLength);return new An(e).set(new An(t)),e},Rn=On;var Sn=function(t,e){var r=e?Rn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},En=/\w*$/;var Dn=function(t){var e=new t.constructor(t.source,En.exec(t));return e.lastIndex=t.lastIndex,e},xn=q?q.prototype:void 0,qn=xn?xn.valueOf:void 0;var In=On;var Pn=On,zn=Sn,Mn=Dn,Un=function(t){return qn?Object(qn.call(t)):{}},Cn=function(t,e){var r=e?In(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)};var Fn=function(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return Pn(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return zn(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Cn(t,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return Mn(t);case"[object Symbol]":return Un(t)}},Tn=L,kn=Object.create,Bn=function(){function t(){}return function(e){if(!Tn(e))return{};if(kn)return kn(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),$n=Ur,Ln=Ke;var Wn=function(t){return"function"!=typeof t.constructor||Ln(t)?{}:Bn($n(t))},Hn=wn,Nn=fe;var Vn=function(t){return Nn(t)&&"[object Map]"==Hn(t)},Gn=ze,Jn=Ue&&Ue.isMap,Kn=Jn?Gn(Jn):Vn,Qn=wn,Xn=fe;var Yn=function(t){return Xn(t)&&"[object Set]"==Qn(t)},Zn=ze,to=Ue&&Ue.isSet,eo=to?Zn(to):Yn,ro=Zt,no=te,oo=ce,ao=lr,io=gr,co=Ar,uo=Or,so=zr,lo=Wr,vo=Qr,fo=tn,po=wn,yo=mn,bo=Fn,ho=Wn,_o=ge,jo=Oe,wo=Kn,go=L,mo=eo,Ao=cr,Oo=_r,Ro="[object Arguments]",So="[object Function]",Eo="[object Object]",Do={};Do[Ro]=Do["[object Array]"]=Do["[object ArrayBuffer]"]=Do["[object DataView]"]=Do["[object Boolean]"]=Do["[object Date]"]=Do["[object Float32Array]"]=Do["[object Float64Array]"]=Do["[object Int8Array]"]=Do["[object Int16Array]"]=Do["[object Int32Array]"]=Do["[object Map]"]=Do["[object Number]"]=Do[Eo]=Do["[object RegExp]"]=Do["[object Set]"]=Do["[object String]"]=Do["[object Symbol]"]=Do["[object Uint8Array]"]=Do["[object Uint8ClampedArray]"]=Do["[object Uint16Array]"]=Do["[object Uint32Array]"]=!0,Do["[object Error]"]=Do[So]=Do["[object WeakMap]"]=!1;var xo=function t(e,r,n,o,a,i){var c,u=1&r,s=2&r,l=4&r;if(n&&(c=a?n(e,o,a,i):n(e)),void 0!==c)return c;if(!go(e))return e;var v=_o(e);if(v){if(c=yo(e),!u)return uo(e,c)}else{var f=po(e),p=f==So||"[object GeneratorFunction]"==f;if(jo(e))return co(e,u);if(f==Eo||f==Ro||p&&!a){if(c=s||p?{}:ho(e),!u)return s?lo(e,io(c,e)):so(e,ao(c,e))}else{if(!Do[f])return a?e:{};c=bo(e,f,u)}}i||(i=new ro);var d=i.get(e);if(d)return d;i.set(e,c),mo(e)?e.forEach((function(o){c.add(t(o,r,n,o,e,i))})):wo(e)&&e.forEach((function(o,a){c.set(a,t(o,r,n,a,e,i))}));var y=v?void 0:(l?s?fo:vo:s?Oo:Ao)(e);return no(y||e,(function(o,a){y&&(o=e[a=o]),oo(c,a,t(o,r,n,a,e,i))})),c},qo=xo;var Io=o((function(t){return qo(t,5)}));exports.DocumentEditor=n=>{const{id:o,documentServerUrl:a,config:i,document_fileType:c,document_title:u,documentType:s,editorConfig_lang:l,height:v,type:f,width:p,onLoadComponentError:d,events_onAppReady:y,events_onDocumentStateChange:b,events_onMetaChange:h,events_onDocumentReady:_,events_onInfo:j,events_onWarning:w,events_onError:g,events_onRequestSharingSettings:m,events_onRequestRename:A,events_onMakeActionLink:O,events_onRequestInsertImage:R,events_onRequestSaveAs:S,events_onRequestMailMergeRecipients:E,events_onRequestCompareFile:D,events_onRequestEditRights:x,events_onRequestHistory:q,events_onRequestHistoryClose:I,events_onRequestHistoryData:P,events_onRequestRestore:z,events_onRequestSelectSpreadsheet:M,events_onRequestSelectDocument:U,events_onRequestUsers:C}=n;t.useEffect((()=>{var t;(null===(t=null===window||void 0===window?void 0:window.DocEditor)||void 0===t?void 0:t.instances[o])&&(window.DocEditor.instances[o].destroyEditor(),window.DocEditor.instances[o]=void 0,console.log("Important props have been changed. Load new Editor."),F())}),[a,JSON.stringify(i),c,u,s,l,v,f,p]),t.useEffect((()=>{let t=a;t.endsWith("/")||(t+="/");return((t,n)=>e(void 0,void 0,void 0,(function*(){return new Promise(((e,o)=>{try{if(window.DocsAPI)return e(null);const a=document.getElementById(n);if(a){let i=setInterval((()=>{if(!a.getAttribute("loading")){if(clearInterval(i),window.DocsAPI)return e(null);const c=r(n,t,e,o);a.remove(),document.body.appendChild(c)}}),500)}else{const a=r(n,t,e,o);document.body.appendChild(a)}}catch(t){console.error(t)}}))})))(`${t}web-apps/apps/api/documents/api.js`,"onlyoffice-api-script").then((()=>F())).catch((()=>B(-2))),()=>{var t;(null===(t=null===window||void 0===window?void 0:window.DocEditor)||void 0===t?void 0:t.instances[o])&&(window.DocEditor.instances[o].destroyEditor(),window.DocEditor.instances[o]=void 0)}}),[]);const F=()=>{var t,e;try{if(window.DocsAPI||B(-3),null===(t=null===window||void 0===window?void 0:window.DocEditor)||void 0===t?void 0:t.instances[o])return void console.log("Skip loading. Instance already exists",o);(null===(e=null===window||void 0===window?void 0:window.DocEditor)||void 0===e?void 0:e.instances)||(window.DocEditor={instances:{}});var r=Io(i),n={documentType:s,events:{onAppReady:$,onDocumentStateChange:b,onMetaChange:h,onDocumentReady:_,onInfo:j,onWarning:w,onError:g,onRequestSharingSettings:m,onRequestRename:A,onMakeActionLink:O,onRequestInsertImage:R,onRequestSaveAs:S,onRequestMailMergeRecipients:E,onRequestCompareFile:D,onRequestEditRights:x,onRequestHistory:q,onRequestHistoryClose:I,onRequestHistoryData:P,onRequestRestore:z,onRequestSelectSpreadsheet:M,onRequestSelectDocument:U,onRequestUsers:C},height:v,type:f,width:p};const a=T(),c=k();null!==a&&(n.document=a),null!==c&&(n.editorConfig=c);let u=Object.assign(n,r||{});const l=window.DocsAPI.DocEditor(o,u);window.DocEditor.instances[o]=l}catch(t){console.error(t),B(-1)}},T=()=>{var t=null;c&&((t=t||{}).fileType=c),c&&((t=t||{}).document_title=u)},k=()=>{var t=null;l&&((t=t||{}).lang=l)},B=t=>{let e;switch(t){case-2:e="Error load DocsAPI from "+a;break;case-3:e="DocsAPI is not defined";break;default:e="Unknown error loading component",t=-1}void 0===d?console.error(e):d(t,e)},$=()=>{y(window.DocEditor.instances[o])};return t.createElement("div",{id:o})};
//# sourceMappingURL=index.js.map
