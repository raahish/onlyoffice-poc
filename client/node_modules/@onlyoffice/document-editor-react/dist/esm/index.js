import t,{useEffect as e}from"react";function r(t,e,r,n){return new(r||(r=Promise))((function(o,a){function i(t){try{u(n.next(t))}catch(t){a(t)}}function c(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,c)}u((n=n.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const n=(t,e,r,n)=>{const o=document.createElement("script");return o.id=t,o.type="text/javascript",o.src=e,o.async=!0,o.onload=()=>{o.removeAttribute("loading"),r(null)},o.onerror=t=>{o.removeAttribute("loading"),n(t)},o.setAttribute("loading",""),o};var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var i=function(){this.__data__=[],this.size=0};var c=function(t,e){return t===e||t!=t&&e!=e},u=c;var s=function(t,e){for(var r=t.length;r--;)if(u(t[r][0],e))return r;return-1},l=s,v=Array.prototype.splice;var f=s;var p=s;var d=s;var y=i,b=function(t){var e=this.__data__,r=l(e,t);return!(r<0)&&(r==e.length-1?e.pop():v.call(e,r,1),--this.size,!0)},h=function(t){var e=this.__data__,r=f(e,t);return r<0?void 0:e[r][1]},_=function(t){return p(this.__data__,t)>-1},j=function(t,e){var r=this.__data__,n=d(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function w(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}w.prototype.clear=y,w.prototype.delete=b,w.prototype.get=h,w.prototype.has=_,w.prototype.set=j;var g=w,m=g;var A=function(){this.__data__=new m,this.size=0};var O=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var R=function(t){return this.__data__.get(t)};var S=function(t){return this.__data__.has(t)},E="object"==typeof o&&o&&o.Object===Object&&o,D=E,x="object"==typeof self&&self&&self.Object===Object&&self,I=D||x||Function("return this")(),q=I.Symbol,P=q,z=Object.prototype,M=z.hasOwnProperty,U=z.toString,C=P?P.toStringTag:void 0;var F=function(t){var e=M.call(t,C),r=t[C];try{t[C]=void 0;var n=!0}catch(t){}var o=U.call(t);return n&&(e?t[C]=r:delete t[C]),o},T=Object.prototype.toString;var k=F,B=function(t){return T.call(t)},$=q?q.toStringTag:void 0;var L=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":$&&$ in Object(t)?k(t):B(t)};var W=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},H=L,N=W;var V,G=function(t){if(!N(t))return!1;var e=H(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},J=I["__core-js_shared__"],K=(V=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"";var Q=function(t){return!!K&&K in t},X=Function.prototype.toString;var Y=function(t){if(null!=t){try{return X.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Z=G,tt=Q,et=W,rt=Y,nt=/^\[object .+?Constructor\]$/,ot=Function.prototype,at=Object.prototype,it=ot.toString,ct=at.hasOwnProperty,ut=RegExp("^"+it.call(ct).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var st=function(t){return!(!et(t)||tt(t))&&(Z(t)?ut:nt).test(rt(t))},lt=function(t,e){return null==t?void 0:t[e]};var vt=function(t,e){var r=lt(t,e);return st(r)?r:void 0},ft=vt(I,"Map"),pt=vt(Object,"create"),dt=pt;var yt=function(){this.__data__=dt?dt(null):{},this.size=0};var bt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ht=pt,_t=Object.prototype.hasOwnProperty;var jt=function(t){var e=this.__data__;if(ht){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return _t.call(e,t)?e[t]:void 0},wt=pt,gt=Object.prototype.hasOwnProperty;var mt=pt;var At=yt,Ot=bt,Rt=jt,St=function(t){var e=this.__data__;return wt?void 0!==e[t]:gt.call(e,t)},Et=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=mt&&void 0===e?"__lodash_hash_undefined__":e,this};function Dt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Dt.prototype.clear=At,Dt.prototype.delete=Ot,Dt.prototype.get=Rt,Dt.prototype.has=St,Dt.prototype.set=Et;var xt=Dt,It=g,qt=ft;var Pt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var zt=function(t,e){var r=t.__data__;return Pt(e)?r["string"==typeof e?"string":"hash"]:r.map},Mt=zt;var Ut=zt;var Ct=zt;var Ft=zt;var Tt=function(){this.size=0,this.__data__={hash:new xt,map:new(qt||It),string:new xt}},kt=function(t){var e=Mt(this,t).delete(t);return this.size-=e?1:0,e},Bt=function(t){return Ut(this,t).get(t)},$t=function(t){return Ct(this,t).has(t)},Lt=function(t,e){var r=Ft(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Wt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Wt.prototype.clear=Tt,Wt.prototype.delete=kt,Wt.prototype.get=Bt,Wt.prototype.has=$t,Wt.prototype.set=Lt;var Ht=g,Nt=ft,Vt=Wt;var Gt=g,Jt=A,Kt=O,Qt=R,Xt=S,Yt=function(t,e){var r=this.__data__;if(r instanceof Ht){var n=r.__data__;if(!Nt||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Vt(n)}return r.set(t,e),this.size=r.size,this};function Zt(t){var e=this.__data__=new Gt(t);this.size=e.size}Zt.prototype.clear=Jt,Zt.prototype.delete=Kt,Zt.prototype.get=Qt,Zt.prototype.has=Xt,Zt.prototype.set=Yt;var te=Zt;var ee=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},re=vt,ne=function(){try{var t=re(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var oe=function(t,e,r){"__proto__"==e&&ne?ne(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},ae=oe,ie=c,ce=Object.prototype.hasOwnProperty;var ue=function(t,e,r){var n=t[e];ce.call(t,e)&&ie(n,r)&&(void 0!==r||e in t)||ae(t,e,r)},se=ue,le=oe;var ve=function(t,e,r,n){var o=!r;r||(r={});for(var a=-1,i=e.length;++a<i;){var c=e[a],u=n?n(r[c],t[c],c,r,t):void 0;void 0===u&&(u=t[c]),o?le(r,c,u):se(r,c,u)}return r};var fe=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var pe=function(t){return null!=t&&"object"==typeof t},de=L,ye=pe;var be=function(t){return ye(t)&&"[object Arguments]"==de(t)},he=pe,_e=Object.prototype,je=_e.hasOwnProperty,we=_e.propertyIsEnumerable,ge=be(function(){return arguments}())?be:function(t){return he(t)&&je.call(t,"callee")&&!we.call(t,"callee")},me=Array.isArray,Ae={exports:{}};var Oe=function(){return!1};!function(t,e){var r=I,n=Oe,o=e&&!e.nodeType&&e,a=o&&t&&!t.nodeType&&t,i=a&&a.exports===o?r.Buffer:void 0,c=(i?i.isBuffer:void 0)||n;t.exports=c}(Ae,Ae.exports);var Re=Ae.exports,Se=/^(?:0|[1-9]\d*)$/;var Ee=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Se.test(t))&&t>-1&&t%1==0&&t<e};var De=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},xe=L,Ie=De,qe=pe,Pe={};Pe["[object Float32Array]"]=Pe["[object Float64Array]"]=Pe["[object Int8Array]"]=Pe["[object Int16Array]"]=Pe["[object Int32Array]"]=Pe["[object Uint8Array]"]=Pe["[object Uint8ClampedArray]"]=Pe["[object Uint16Array]"]=Pe["[object Uint32Array]"]=!0,Pe["[object Arguments]"]=Pe["[object Array]"]=Pe["[object ArrayBuffer]"]=Pe["[object Boolean]"]=Pe["[object DataView]"]=Pe["[object Date]"]=Pe["[object Error]"]=Pe["[object Function]"]=Pe["[object Map]"]=Pe["[object Number]"]=Pe["[object Object]"]=Pe["[object RegExp]"]=Pe["[object Set]"]=Pe["[object String]"]=Pe["[object WeakMap]"]=!1;var ze=function(t){return qe(t)&&Ie(t.length)&&!!Pe[xe(t)]};var Me=function(t){return function(e){return t(e)}},Ue={exports:{}};!function(t,e){var r=E,n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,a=o&&o.exports===n&&r.process,i=function(){try{var t=o&&o.require&&o.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=i}(Ue,Ue.exports);var Ce=Ue.exports,Fe=ze,Te=Me,ke=Ce&&Ce.isTypedArray,Be=ke?Te(ke):Fe,$e=fe,Le=ge,We=me,He=Re,Ne=Ee,Ve=Be,Ge=Object.prototype.hasOwnProperty;var Je=function(t,e){var r=We(t),n=!r&&Le(t),o=!r&&!n&&He(t),a=!r&&!n&&!o&&Ve(t),i=r||n||o||a,c=i?$e(t.length,String):[],u=c.length;for(var s in t)!e&&!Ge.call(t,s)||i&&("length"==s||o&&("offset"==s||"parent"==s)||a&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Ne(s,u))||c.push(s);return c},Ke=Object.prototype;var Qe=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ke)};var Xe=function(t,e){return function(r){return t(e(r))}},Ye=Xe(Object.keys,Object),Ze=Qe,tr=Ye,er=Object.prototype.hasOwnProperty;var rr=G,nr=De;var or=function(t){return null!=t&&nr(t.length)&&!rr(t)},ar=Je,ir=function(t){if(!Ze(t))return tr(t);var e=[];for(var r in Object(t))er.call(t,r)&&"constructor"!=r&&e.push(r);return e},cr=or;var ur=function(t){return cr(t)?ar(t):ir(t)},sr=ve,lr=ur;var vr=function(t,e){return t&&sr(e,lr(e),t)};var fr=W,pr=Qe,dr=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},yr=Object.prototype.hasOwnProperty;var br=Je,hr=function(t){if(!fr(t))return dr(t);var e=pr(t),r=[];for(var n in t)("constructor"!=n||!e&&yr.call(t,n))&&r.push(n);return r},_r=or;var jr=function(t){return _r(t)?br(t,!0):hr(t)},wr=ve,gr=jr;var mr=function(t,e){return t&&wr(e,gr(e),t)},Ar={exports:{}};!function(t,e){var r=I,n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,a=o&&o.exports===n?r.Buffer:void 0,i=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=i?i(r):new t.constructor(r);return t.copy(n),n}}(Ar,Ar.exports);var Or=Ar.exports;var Rr=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var Sr=function(){return[]},Er=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,a=[];++r<n;){var i=t[r];e(i,r,t)&&(a[o++]=i)}return a},Dr=Sr,xr=Object.prototype.propertyIsEnumerable,Ir=Object.getOwnPropertySymbols,qr=Ir?function(t){return null==t?[]:(t=Object(t),Er(Ir(t),(function(e){return xr.call(t,e)})))}:Dr,Pr=ve,zr=qr;var Mr=function(t,e){return Pr(t,zr(t),e)};var Ur=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t},Cr=Xe(Object.getPrototypeOf,Object),Fr=Ur,Tr=Cr,kr=qr,Br=Sr,$r=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Fr(e,kr(t)),t=Tr(t);return e}:Br,Lr=ve,Wr=$r;var Hr=function(t,e){return Lr(t,Wr(t),e)},Nr=Ur,Vr=me;var Gr=function(t,e,r){var n=e(t);return Vr(t)?n:Nr(n,r(t))},Jr=Gr,Kr=qr,Qr=ur;var Xr=function(t){return Jr(t,Qr,Kr)},Yr=Gr,Zr=$r,tn=jr;var en=function(t){return Yr(t,tn,Zr)},rn=vt(I,"DataView"),nn=ft,on=vt(I,"Promise"),an=vt(I,"Set"),cn=vt(I,"WeakMap"),un=L,sn=Y,ln="[object Map]",vn="[object Promise]",fn="[object Set]",pn="[object WeakMap]",dn="[object DataView]",yn=sn(rn),bn=sn(nn),hn=sn(on),_n=sn(an),jn=sn(cn),wn=un;(rn&&wn(new rn(new ArrayBuffer(1)))!=dn||nn&&wn(new nn)!=ln||on&&wn(on.resolve())!=vn||an&&wn(new an)!=fn||cn&&wn(new cn)!=pn)&&(wn=function(t){var e=un(t),r="[object Object]"==e?t.constructor:void 0,n=r?sn(r):"";if(n)switch(n){case yn:return dn;case bn:return ln;case hn:return vn;case _n:return fn;case jn:return pn}return e});var gn=wn,mn=Object.prototype.hasOwnProperty;var An=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&mn.call(t,"index")&&(r.index=t.index,r.input=t.input),r},On=I.Uint8Array;var Rn=function(t){var e=new t.constructor(t.byteLength);return new On(e).set(new On(t)),e},Sn=Rn;var En=function(t,e){var r=e?Sn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},Dn=/\w*$/;var xn=function(t){var e=new t.constructor(t.source,Dn.exec(t));return e.lastIndex=t.lastIndex,e},In=q?q.prototype:void 0,qn=In?In.valueOf:void 0;var Pn=Rn;var zn=Rn,Mn=En,Un=xn,Cn=function(t){return qn?Object(qn.call(t)):{}},Fn=function(t,e){var r=e?Pn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)};var Tn=function(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return zn(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return Mn(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Fn(t,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return Un(t);case"[object Symbol]":return Cn(t)}},kn=W,Bn=Object.create,$n=function(){function t(){}return function(e){if(!kn(e))return{};if(Bn)return Bn(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),Ln=Cr,Wn=Qe;var Hn=function(t){return"function"!=typeof t.constructor||Wn(t)?{}:$n(Ln(t))},Nn=gn,Vn=pe;var Gn=function(t){return Vn(t)&&"[object Map]"==Nn(t)},Jn=Me,Kn=Ce&&Ce.isMap,Qn=Kn?Jn(Kn):Gn,Xn=gn,Yn=pe;var Zn=function(t){return Yn(t)&&"[object Set]"==Xn(t)},to=Me,eo=Ce&&Ce.isSet,ro=eo?to(eo):Zn,no=te,oo=ee,ao=ue,io=vr,co=mr,uo=Or,so=Rr,lo=Mr,vo=Hr,fo=Xr,po=en,yo=gn,bo=An,ho=Tn,_o=Hn,jo=me,wo=Re,go=Qn,mo=W,Ao=ro,Oo=ur,Ro=jr,So="[object Arguments]",Eo="[object Function]",Do="[object Object]",xo={};xo[So]=xo["[object Array]"]=xo["[object ArrayBuffer]"]=xo["[object DataView]"]=xo["[object Boolean]"]=xo["[object Date]"]=xo["[object Float32Array]"]=xo["[object Float64Array]"]=xo["[object Int8Array]"]=xo["[object Int16Array]"]=xo["[object Int32Array]"]=xo["[object Map]"]=xo["[object Number]"]=xo[Do]=xo["[object RegExp]"]=xo["[object Set]"]=xo["[object String]"]=xo["[object Symbol]"]=xo["[object Uint8Array]"]=xo["[object Uint8ClampedArray]"]=xo["[object Uint16Array]"]=xo["[object Uint32Array]"]=!0,xo["[object Error]"]=xo[Eo]=xo["[object WeakMap]"]=!1;var Io=function t(e,r,n,o,a,i){var c,u=1&r,s=2&r,l=4&r;if(n&&(c=a?n(e,o,a,i):n(e)),void 0!==c)return c;if(!mo(e))return e;var v=jo(e);if(v){if(c=bo(e),!u)return so(e,c)}else{var f=yo(e),p=f==Eo||"[object GeneratorFunction]"==f;if(wo(e))return uo(e,u);if(f==Do||f==So||p&&!a){if(c=s||p?{}:_o(e),!u)return s?vo(e,co(c,e)):lo(e,io(c,e))}else{if(!xo[f])return a?e:{};c=ho(e,f,u)}}i||(i=new no);var d=i.get(e);if(d)return d;i.set(e,c),Ao(e)?e.forEach((function(o){c.add(t(o,r,n,o,e,i))})):go(e)&&e.forEach((function(o,a){c.set(a,t(o,r,n,a,e,i))}));var y=v?void 0:(l?s?po:fo:s?Ro:Oo)(e);return oo(y||e,(function(o,a){y&&(o=e[a=o]),ao(c,a,t(o,r,n,a,e,i))})),c},qo=Io;var Po=a((function(t){return qo(t,5)}));const zo=o=>{const{id:a,documentServerUrl:i,config:c,document_fileType:u,document_title:s,documentType:l,editorConfig_lang:v,height:f,type:p,width:d,onLoadComponentError:y,events_onAppReady:b,events_onDocumentStateChange:h,events_onMetaChange:_,events_onDocumentReady:j,events_onInfo:w,events_onWarning:g,events_onError:m,events_onRequestSharingSettings:A,events_onRequestRename:O,events_onMakeActionLink:R,events_onRequestInsertImage:S,events_onRequestSaveAs:E,events_onRequestMailMergeRecipients:D,events_onRequestCompareFile:x,events_onRequestEditRights:I,events_onRequestHistory:q,events_onRequestHistoryClose:P,events_onRequestHistoryData:z,events_onRequestRestore:M,events_onRequestSelectSpreadsheet:U,events_onRequestSelectDocument:C,events_onRequestUsers:F}=o;e((()=>{var t;(null===(t=null===window||void 0===window?void 0:window.DocEditor)||void 0===t?void 0:t.instances[a])&&(window.DocEditor.instances[a].destroyEditor(),window.DocEditor.instances[a]=void 0,console.log("Important props have been changed. Load new Editor."),T())}),[i,JSON.stringify(c),u,s,l,v,f,p,d]),e((()=>{let t=i;t.endsWith("/")||(t+="/");return((t,e)=>r(void 0,void 0,void 0,(function*(){return new Promise(((r,o)=>{try{if(window.DocsAPI)return r(null);const a=document.getElementById(e);if(a){let i=setInterval((()=>{if(!a.getAttribute("loading")){if(clearInterval(i),window.DocsAPI)return r(null);const c=n(e,t,r,o);a.remove(),document.body.appendChild(c)}}),500)}else{const a=n(e,t,r,o);document.body.appendChild(a)}}catch(t){console.error(t)}}))})))(`${t}web-apps/apps/api/documents/api.js`,"onlyoffice-api-script").then((()=>T())).catch((()=>$(-2))),()=>{var t;(null===(t=null===window||void 0===window?void 0:window.DocEditor)||void 0===t?void 0:t.instances[a])&&(window.DocEditor.instances[a].destroyEditor(),window.DocEditor.instances[a]=void 0)}}),[]);const T=()=>{var t,e;try{if(window.DocsAPI||$(-3),null===(t=null===window||void 0===window?void 0:window.DocEditor)||void 0===t?void 0:t.instances[a])return void console.log("Skip loading. Instance already exists",a);(null===(e=null===window||void 0===window?void 0:window.DocEditor)||void 0===e?void 0:e.instances)||(window.DocEditor={instances:{}});var r=Po(c),n={documentType:l,events:{onAppReady:L,onDocumentStateChange:h,onMetaChange:_,onDocumentReady:j,onInfo:w,onWarning:g,onError:m,onRequestSharingSettings:A,onRequestRename:O,onMakeActionLink:R,onRequestInsertImage:S,onRequestSaveAs:E,onRequestMailMergeRecipients:D,onRequestCompareFile:x,onRequestEditRights:I,onRequestHistory:q,onRequestHistoryClose:P,onRequestHistoryData:z,onRequestRestore:M,onRequestSelectSpreadsheet:U,onRequestSelectDocument:C,onRequestUsers:F},height:f,type:p,width:d};const o=k(),i=B();null!==o&&(n.document=o),null!==i&&(n.editorConfig=i);let u=Object.assign(n,r||{});const s=window.DocsAPI.DocEditor(a,u);window.DocEditor.instances[a]=s}catch(t){console.error(t),$(-1)}},k=()=>{var t=null;u&&((t=t||{}).fileType=u),u&&((t=t||{}).document_title=s)},B=()=>{var t=null;v&&((t=t||{}).lang=v)},$=t=>{let e;switch(t){case-2:e="Error load DocsAPI from "+i;break;case-3:e="DocsAPI is not defined";break;default:e="Unknown error loading component",t=-1}void 0===y?console.error(e):y(t,e)},L=()=>{b(window.DocEditor.instances[a])};return t.createElement("div",{id:a})};export{zo as DocumentEditor};
//# sourceMappingURL=index.js.map
